---
title: JS运行机制
date: 2022-07-20 08:09:26
tags:

categories:
  - 前端面试八股
---

### 线程和进程

**线程**  
线程是 CPU 调度的最小单位  
一个进程可以有多个线程  
同一进程下的各个线程间共享程序的内存空间及一些进程级的资源  
线程上下文切换比进程上下文切换要快得多

> 多线程：指程序中包含多个执行流，即在一个程序中可以同时运行多个不同的线程来执行不同的任务

<br>

**进程**  
进程是 CPU 资源分配的最小单位  
进程包括运行中的程序和程序所使用到的内存和系统资源  
每个进程之间是相互独立的

> 多进程：指的是在同一个时间里，同一个计算机系统中如果允许两个或两个以上的进程处于运行状态

<br>

### 事件循环概述

**同步任务**  
他们都在主线程(即 JS 引擎线程)上执行，会形成一个 `执行栈`

<br>

**异步任务**  
诸如 setTimeout，首先在定时触发器线程中进行计时；  
计时完毕，将任务加入到事件触发线程的 `任务队列` 中；  
等执行栈 `空闲` 时，逐一取出任务队列的任务并开始执行

<br>

> 所谓事件循环，即定时触发器线程、事件触发线程、JS 引擎线程之间任务的轮转处理的整个过程；
> 这三个线程之间独立性较高

<br>

### 宏任务和微任务

<br>

**宏任务 macrotask/task**  
将每次执行栈执行的代码当做是一个宏任务；  
在任何一个宏任务执行期间，其他任务不会执行；

一些宏任务：主代码块、setTimeout、setInterval、requestAnimationFrame

> 一个宏任务执行结果后，在下一个宏任务执行前，GUI 渲染线程开始工作，对页面进行渲染，依次循环交替运行

<br>

**微任务 microtask/jobs**  
定义：在当前宏任务执行后立即执行的任务
`简明执行顺序`： 宏任务 -> 是否存在微任务?执行:跳过 -> GUI 渲染 -> 下一个宏任务

常见微任务：process.nextTick ()-Node、Promise.then()、catch、finally、Object.observe

<br>
